<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Условные подмаски</title>

 </head>
 <body><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="regexp.reference.onlyonce.html">Однократные подмаски</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="regexp.reference.comments.html">Комментарии</a></div>
 <div class="up"><a href="reference.pcre.pattern.syntax.html">Описание синтаксиса Perl-совместимых регулярных выражений</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="regexp.reference.conditional" class="section">
  <h2 class="title">Условные подмаски</h2>
  <p class="para">
   В PCRE реализована возможность подчинять шаблон условию либо выбирать
   из двух условных подмасок в зависимости от успеха сопоставления
   предыдущей подмаски. Условные подмаски имеют две допустимые формы
   использования:
  </p>

  <div class="informalexample">
   <div class="example-contents">
<div class="cdata"><pre>
(?(condition)yes-pattern)
(?(condition)yes-pattern|no-pattern)
</pre></div>
   </div>

  </div>
  <p class="para">
   В случае успешного сопоставления условия condition, используется
   подмаска yes-pattern, в противном случае no-pattern
   (если он присутствует). Если указано более двух альтернатив,
   возникнет ошибка во время компиляции.
  </p>
  <p class="para">
   Условия бывают двух видов. В случае, если между скобками
   заключены цифры, условие будет выполняться в том случае,
   если подмаска с соответствующим номером была успешно сопоставлена.
   Рассмотрим следующий шаблон (он содержит незначащий пробел для удобства
   чтения, подразумевается использование модификатора
   <a href="reference.pcre.pattern.modifiers.html" class="link">PCRE_EXTENDED</a>),
   разделив его для удобства на три смысловые части:

   <em>( \( )?    [^()]+    (?(1) \) )</em>
  </p>
  <p class="para">
   Первая часть соответствует опциональной открывающей скобке,
   и в случае если она присутствует, захватывает ее как значение
   первой подмаски. Следующая часть соответствует одному или более
   символам, отличным от круглой скобки. Третья часть является условной
   подмаской, зависящей от результата сопоставления первой подмаски.
   В случае, если в начале обрабатываемых данных была обнаружена
   открывающая круглая скобка, условие будет интерпретировано как
   истина, и, следовательно, для успешного сопоставления третьей
   части шаблона необходима закрывающая круглая скобка. В противном случае,
   поскольку не указана вторая ветвь условного шаблона, третья часть
   будет сопоставлена с пустой строкой. Суммируя все вышесказанное,
   приведенный шаблон совпадает с последовательностью не-скобок,
   возможно, заключенной в круглые скобки.
  </p>
  <p class="para">
   Если условием является строка <em>(R)</em>, оно будет
   выполнено, если будет произведен рекурсивный вызов к шаблону или
   подмаске. На &quot;самом верхнем уровне&quot; условие ложно.
  </p>
  <p class="para">
   Если условие не является последовательностью цифр или (R),
   оно должно быть утверждением.  Это может быть либо положительная
   или отрицательная проверка последующего либо предыдущего текста.
   Рассмотрим данный шаблон, снова содержащий незначащие пробелы,
   с двумя альтернативами на второй строке:
  </p>

  <div class="informalexample">
   <div class="example-contents">
<div class="cdata"><pre>
(?(?=[^a-z]*[a-z])
\d{2}-[a-z]{3}-\d{2}  |  \d{2}-\d{2}-\d{2} )
</pre></div>
   </div>

  </div>
  <p class="para">
   Приведен пример с утверждающим условием касательно предшествующего
   текста, которое выполняется для необязательной последовательности
   не-букв с последующей буквой. Говоря другими словами, указанное
   условие проверяет наличие хотя бы одной предшествующей буквы.
   В случае, если буква найдена, выполняется сопоставление с первой
   альтернативой, в противном случае - со второй альтернативой.
   Приведенный шаблон соответствует строкам двух видов:
   dd-aaa-dd либо dd-dd-dd, где aaaa - это буквы, а dd - цифры.
  </p>
 </div><hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="regexp.reference.onlyonce.html">Однократные подмаски</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="regexp.reference.comments.html">Комментарии</a></div>
 <div class="up"><a href="reference.pcre.pattern.syntax.html">Описание синтаксиса Perl-совместимых регулярных выражений</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
